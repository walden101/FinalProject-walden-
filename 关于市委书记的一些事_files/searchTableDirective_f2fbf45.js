angular.module("BC.directives").directive("searchTable",["$filter","$timeout",function(e){return{link:function(l,t,i){function r(){var t=l.$eval(i.ngModel);l.original_folderList?(s=angular.copy(o),u=!0):(s=l.folderList,u=!1),copy_folder_list=angular.copy(o);var r=[],d=[],f=!1,c=!1;t?s&&(n=[],a={},angular.forEach(s,function(l){f=!1,c=!1,r=e("query_tables")(l.tb_list,t),l.tb_list=r.length>0?r:[],f=r.length>0,l.sub_folders&&l.sub_folders.length>0&&(d=[],angular.forEach(l.sub_folders,function(l){r=e("query_tables")(l.tb_list,t),l.tb_list=r.length>0?r:[],l.open=r.length>0,r.length>0&&d.push(l)}),l.sub_folders=d,c=d.length>0),(f||c)&&(l.open=!0,n.push(l))}),l.folderList=n,l.$emit("recoverFolderList",l.folderList)):(l.folderList=copy_folder_list,l.selected&&l.selected.tb_id&&l.highlightByTableId(l.folderList,l.selected.tb_id),l.$emit("recoverFolderList",l.folderList)),l.$apply()}var o,s,n,a,d,u=!0;l.searchOriginList=[],l.$on("updatefolderList",function(e,t){t&&(o=t===!0?l.folderList:t)}),o=angular.copy(l.original_folderList?l.original_folderList:l.folderList),angular.element(t).on("keyup.searchTable",function(){clearTimeout(d),d=setTimeout(r,100)})}}}]);